@using MudBlazor.Utilities
@using WeddingWebsite.Models.WebsiteConfig
@inherits LayoutComponentBase

@inject IWebsiteConfig Config

<MudPopoverProvider />
<MudDialogProvider />

<div class="page">
    <main>
        <AuthorizeView>
            <Authorized>
                <div class="top-row" style="background-color: @Config.Colours.PrimaryBackground">
                    <a href="/">Home</a>
                    <a href="/#timeline" class="desktop-only">Timeline & Logistics</a>
                    <a href="/#accommodation" class="desktop-only">Accommodation</a>
                    <a href="javascript:alert('Registry is not yet available');">Registry</a>
                    <a href="javascript:alert('Gallery is not yet available');">Gallery</a>
                    <a href="/#contact" class="desktop-only">Contact</a>
                    <MudSpacer/>
                    <a href="/Account/Logout">Logout</a>
                </div>
            </Authorized>
        </AuthorizeView>

        <article class="content">
            @Body
        </article>
    </main>
</div>

<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">🗙</span>
</div>

<style>
    body {
        @Config.Colours.Surface.GetBackgroundCss();
    }
</style>


<MudThemeProvider Theme="Theme" />

@code{
    MudTheme? Theme {get; set;}
    
    protected override void OnInitialized() {
        Theme = new MudTheme()
        {
            PaletteLight = new PaletteLight()
            {
                Primary = Config.Colours.Primary.ToString(),
                PrimaryLighten = Config.Colours.PrimaryBackground.ToString(),
                Secondary = Config.Colours.Secondary.ToString(),
                Surface = (Config.Colours.Surface as Colour)?.ToString() ?? Colour.White.ToString()
            },
        };
    } 
}

