@using WeddingWebsite.Components.Containers
@using WeddingWebsite.Models.ConfigInterfaces
@using WeddingWebsite.Models.Theme

@inject IStringProvider StringProvider

<a href="/registry/@Item.Id">
    <Box CustomCss="height: 300px;">
        <TopContent>
            @if (Item.ImageUrl != null)
            {
                <img src="@Item.ImageUrl" alt=""/>
            }
        </TopContent>
        <ChildContent>
            <p class="generic-name">@Item.GenericName</p>
            <h2>@Item.Name</h2>
            <div class="cost-and-button">
                @if (Item.PurchaseMethods.Any())
                {
                    @if (ButtonText is "Pending" or "Completed" && Item.MaxQuantity > 1)
                    {
                        <p><span class="cost">@StringProvider.CurrencyAmount(Item.CheapestCost)</span> × @Item.QuantityClaimed</p>
                    } else if (Item.MaxQuantity-Item.QuantityClaimed > 1)
                    {
                        <p><span class="cost">@StringProvider.CurrencyAmount(Item.CheapestCost)</span> × @(Item.MaxQuantity-Item.QuantityClaimed)</p>
                    }
                    else
                    {
                        <p class="cost">@StringProvider.CurrencyAmount(Item.CheapestCost)</p>
                    }
                }
                else
                {
                    <p class="cost"></p>
                }
                <button style="background: @ButtonColour">@ButtonText</button>
            </div>

        </ChildContent>
    </Box>
</a>

@code {
    [Parameter]
    public required Models.Registry.RegistryItem Item { get; set; }
    
    [Parameter]
    public string ButtonText { get; set; } = "View";
    
    [Parameter]
    public bool ButtonSuccess { get; set; } = true;
    
    [CascadingParameter]
    private SectionTheme? Theme { get; set; }
    
    private string ButtonColour => ButtonSuccess ? (Theme?.Primary.ToString() ?? "var(--primary)") : "#aaaaaa";
}